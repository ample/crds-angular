<section ng-show="profile.viewReady" class="email-modal">
  <ng-form role="form" name="profile.pform" novalidate>
    <p class="push-bottom" ng-bind-html="$root.MESSAGES.privacy.content | html"></p>

    <div class="row">
      <div class="form-group col-sm-6" ng-class="{'has-error': profile.validation.showErrors(profile.pform, 'firstName')}">
        <label for="firstname" class="required">First Name</label>
        <input type="text" class="form-control" id="first-name" name="firstName" placeholder="Enter first name" ng-model="profile.profileData.person.firstName" required>
        <ng-messages for="profile.pform.firstName.$error" ng-if="profile.validation.showErrors(profile.pform, 'firstName')">
          <span ng-message="required">
            <span ng-bind-html="$root.MESSAGES.fieldCanNotBeBlank.content | html"></span>
          </span>
        </ng-messages>
      </div>

      <div class="form-group col-sm-6">
        <label for="middlename">Middle Name</label>
        <input type="text" class="form-control" id="middle-name" placeholder="Enter middle name" ng-model="profile.profileData.person.middleName">
      </div>
    </div>

    <div class="row">
      <div class="form-group col-sm-6" ng-class="{'has-error': profile.validation.showErrors(profile.pform, 'lastName')}">
        <label for="lastname" class="required">Last Name</label>
        <input type="text" class="form-control" id="last-name" name="lastName" placeholder="Enter last name" ng-model="profile.profileData.person.lastName" required>
        <ng-messages for="profile.pform.lastName.$error" ng-if="profile.validation.showErrors(profile.pform, 'lastName')">
          <span ng-message="required">
            <span ng-bind-html="$root.MESSAGES.fieldCanNotBeBlank.content | html"></span>
          </span>
        </ng-messages>
      </div>

      <div class="form-group col-sm-6">
        <label for="maidenname">Maiden Name</label>
        <input type="text" class="form-control" id="maidenname" placeholder="Enter maiden name" ng-model='profile.profileData.person.maidenName'>
      </div>
    </div>

    <div class="row">
      <div class="form-group col-sm-6" ng-class="{'has-error': profile.validation.showErrors(profile.pform, 'nickname')}">
        <label for="nickname" class="required">Preferred Name <small class="text-muted">(Example: Chris instead of Christopher)</small> </label>
        <input type="text" class="form-control" id="nickname" name="nickname" placeholder="Enter nick name" ng-model="profile.profileData.person.nickName" required>
        <ng-messages for="profile.pform.nickname.$error" ng-if="profile.validation.showErrors(profile.pform, 'nickname')">
          <span ng-message="required">
            <span ng-bind-html="$root.MESSAGES.fieldCanNotBeBlank.content | html"></span>
          </span>
        </ng-messages>
      </div>
    </div>

    <div class="row">
      <div class="form-group col-sm-6"  ng-class="{'has-error': profile.validation.showErrors(profile.pform, 'email')}" >
        <label for="email" class="required">Email</label>
        <input type="email"
               class="form-control"
               id="email"
               name="email"
               placeholder="Enter email address"
               ng-model="profile.profileData.person.emailAddress"
               required
               unique-email />
        <ng-messages for="profile.pform.email.$error" ng-if="profile.validation.showErrors(profile.pform, 'email')">
          <span ng-message="required">
            <span ng-bind-html="$root.MESSAGES.fieldCanNotBeBlank.content | html"></span>
          </span>
          <span ng-message="unique">
            <span ng-bind-html="$root.MESSAGES.emailInUse.content | html"></span>
          </span>
          <span ng-message="email">
            <span ng-bind-html="$root.MESSAGES.invalidEmail.content | html"></span>
          </span>
        </ng-messages>
      </div>

      <div class="form-group col-sm-6" ng-if="profile.allowPasswordChange">
        <label for="password">Change Password</label>
        <div class="input-group">
          <input type="password" class="form-control" id="password" name="password" ng-model="fields.password" value="testpassword" />
          <!--<input type="text" class="form-control" id="password-clear" name="password" ng-model="fields.password" ng-if="showPassword" value="testpassword" />-->
          <span class="input-group-addon">
        <label>
          <input type="checkbox" ng-click="showPassword = !showPassword"> Show
        </label>
        </span>
          </div>
          <!-- /input-group -->
      </div>
    </div>

    <div class="row">
      <div class="form-group col-sm-6" ng-class="{'has-error': profile.validation.showErrors(profile.pform, 'birthdate')}" >
        <label for="birthdate" class="required">Birth Date</label>
        <span class="input-group datepicker">
          <input type="text"
                 class="form-control"
                 name="birthdate"
                 id="birthdate"
                 placeholder="mm/dd/yyyy"
                 datepicker-popup="MM/dd/yyyy"
                 ng-model='profile.profileData.person.dateOfBirth'
                 is-open='profile.birthdateOpen'
                 show-button-bar='false'
                 max-date={{profile.minBirthdate}}
                 min-date={{profile.oneHundredFiftyYearsAgo}}
                 init-date=profile.thirteenYearsAgo
                 ng-required="true"
                 datepicker-validator
                 required>
          <span class="input-group-btn">
            <button type="button" class="btn btn-default" ng-click="profile.openBirthdatePicker($event)"><i class="glyphicon glyphicon-calendar"></i></button>
          </span>
        </span>
        <ng-messages for="profile.pform.birthdate.$error" ng-if="profile.validation.showErrors(profile.pform, 'birthdate')">
          <ng-messages-include src="on-submit-messages"></ng-messages-include>
          <span ng-message="date">
            <span ng-bind-html="$root.MESSAGES.invalidData.content | html"></span>
          </span>
          <span ng-message="minDate">
            <span ng-bind-html="$root.MESSAGES.invalidData.content | html"></span>
          </span>
          <span ng-message="maxDate">
            <span ng-if="profile.enforceAgeRestriction" ng-bind-html="$root.MESSAGES.thirteenOrOlder.content | html"></span>
            <span ng-if="!profile.enforceAgeRestriction"  ng-bind-html="$root.MESSAGES.invalidData.content | html"></span>
          </span>
        </ng-messages>
      </div>
    </div>

    <div class="row">
        <div class="form-group col-sm-6">
            <label for="marital_status">Marital Status</label>
            <select class="form-control col-sm-12" ng-model="profile.profileData.person.maritalStatusId" ng-options="status.dp_RecordID as status.dp_RecordName for status in profile.maritalStatuses">
              <option value="" disabled="disabled" selected="selected" style="display:none"> -- Choose One -- </option>
            </select>
        </div>

        <div class="form-group col-sm-6" ng-class="{'has-error':  profile.validation.showErrors(profile.pform, 'gender')}" >
            <label class="block required">Gender</label>
            <label class="radio-inline" ng-repeat="gender in profile.genders">
                <input type="radio"
                  id="gender-{{ gender.dp_RecordName}}"
                  name="gender"
                  ng-value="gender.dp_RecordID"
                  ng-model="profile.profileData.person.genderId"
                  required > {{ gender.dp_RecordName }}
            </label>
           <ng-messages for="profile.pform.gender.$error" ng-if="profile.validation.showErrors(profile.pform, 'gender')">
            <ng-messages-include src="on-submit-messages"></ng-messages-include>
            <ng-messages-include src="on-pause-messages"></ng-messages-include>
          </ng-messages>
        </div>
    </div>

    <div class="row" ng-if='!profile.forTrips'>
      <div class="form-group col-sm-12">
         <label for="ethnicity">Ethnicity <span class="small text-muted">Select all that apply</span></label>
         <div class="profile-ethnicity">
           <div class="checkbox" ng-repeat="ethnicity in profile.ethnicities">
              <label>
                <input type="checkbox" ng-model="ethnicity.selected">
                {{ethnicity.name}}
              </label>
           </div>
          </div>
      </div>
    </div>

    <div class="row">
        <div class="form-group col-sm-6">
            <label for="employer">Employer</label>
            <input type="text" class="form-control" id="employer" placeholder="Enter employer" ng-model='profile.profileData.person.employerName'>
        </div>
    </div>

    <div class="row">
      <div class="form-group col-sm-6" ng-class="{'has-error': profile.validation.showErrors(profile.pform, 'startAttendDate')}" >
        <label for="startAttendDate" class="required">When did you start attending Crossroads?</label>
        <span class="input-group datepicker">
          <input type="text"
                 class="form-control"
                 name="startAttendDate"
                 id="startAttendDate"
                 placeholder="mm/yyyy"
                 datepicker-popup="MM/yyyy"
                 datepicker-options="{minMode: 'month'}"
                 datepicker-mode="'month'"
                 ng-model='profile.profileData.person.anniversaryDate'
                 is-open='profile.startAttendingOpen'
                 close-text="Close"
                 min-date={{profile.crossroadsStartDate}}
                 max-date={{profile.today}}
                 ng-model-options="{updateOn:'blur'}"
                 datepicker-validator
                 ng-required="true"
                 required>
          <span class="input-group-btn">
            <button type="button" class="btn btn-default" ng-click="profile.openStartAttendingDatePicker($event)"><i class="glyphicon glyphicon-calendar"></i></button>
          </span>
        </span>
        <ng-messages for="profile.pform.startAttendDate.$error" ng-if="profile.validation.showErrors(profile.pform, 'startAttendDate')">
          <ng-messages-include src="on-submit-messages"></ng-messages-include>
          <span ng-message="date">
            <span ng-bind-html="$root.MESSAGES.invalidData.content | html"></span>
          </span>
          <span ng-message="minDate">
            <span ng-bind-html="$root.MESSAGES.invalidData.content | html"></span>
          </span>
          <span ng-message="maxDate">
            <span ng-bind-html="$root.MESSAGES.invalidData.content | html"></span>
          </span>
        </ng-messages>
      </div>
      <div class="form-group col-sm-6" >
        <label for="start-attend-reason">Why did you start attending Crossroads?
            <a><svg viewBox="0 0 32 32"
                 class="icon icon-question-circle icon-subtle pointer hidden-xs visible-sm-inline visible-md-inline visible-lg-inline"
                 popover="We want to know the first time you engaged in crossroads. Please remember, select the first invitation or reason you engaged crossroads."
                 popover-placement="right"
                 popover-append-to-body="true"
                 popover-trigger="focus">
                <use xlink:href="#question-circle"></use>
              </svg></a>
<!--
            <svg viewBox="0 0 32 32"
                 class="icon icon-question-circle icon-subtle pointer visible-xs-inline"
                 ng-click="infoCollapsed = !infoCollapsed">
                <use xlink:href="#question-circle"></use>
            </svg>
            <div collapse="!infoCollapsed">
                <div class="well well-sm">We want to know the first time you engaged in crossroads. Please remember, select the first invitation or reason you engaged crossroads.</div>
            </div>
-->
        </label>
        <select name="start-attend-reason"
                class="form-control col-sm-12"
                id="start-attend-reason"
                ng-model="profile.startAttendReason.attribute"
                ng-options="startAttendReason.name for startAttendReason in profile.startAttendReasons.attributes | orderBy: 'attributeId'  track by startAttendReason.attributeId" >
          <option value="" disabled="disabled" selected="selected" style="display:none"> -- Choose One -- </option>
        </select>
      </div>
    </div>

    <div class="row">
      <div class="form-group col-sm-6" ng-class="{'has-error':  profile.validation.showErrors(profile.pform, 'mobile-phone') && profile.requireMobilePhone }" >
        <label for="mobile-phone" ng-class="{'required': profile.requireMobilePhone}">Mobile Phone</label>
          <div class="small inline bold">
            <span ng-show="phoneToggle" class="link-styling" ng-click="phoneToggle = !phoneToggle">Don't have a mobile phone?</span>
            <span ng-show="!phoneToggle" class="text-muted">Edit your household phone <a class="pointer" ng-click="profile.householdPhoneFocus()">here</a>.</span>
          </div>
          <input type="text"
                 class="form-control"
                 name="mobile-phone"
                 id='mobile-phone'
                 placeholder="Enter mobile phone"
                 ng-model="profile.profileData.person.mobilePhone"
                 ng-required='profile.requireMobilePhone'
                 ng-pattern='profile.phoneFormat' >
          <ng-messages for="profile.pform['mobile-phone'].$error" ng-if="profile.validation.showErrors(profile.pform, 'mobile-phone') && profile.requireMobilePhone" >
            <span ng-message='required'>
              <span ng-bind-html='$root.MESSAGES.fieldCanNotBeBlank.content | html'></span>
            </span>
            <span ng-message="pattern"><span ng-bind-html="$root.MESSAGES.invalidPhone.content | html"></span></span>
          </ng-messages>
      </div>

      <div class="form-group col-sm-6" >
        <label for="provider">Service Provider</label>
        <select name="service-provider"
                class="form-control col-sm-12"
                id="service-provider"
                ng-model="profile.profileData.person.mobileCarrierId"
                ng-options="providers.dp_RecordID as providers.dp_RecordName for providers in profile.serviceProviders" >
            <option value="" disabled="disabled" selected="selected" style="display:none"> -- Choose One -- </option>
        </select>
      </div>
    </div>

    <div class="row">
      <profile-picture ng-if='profile.forTrips' />
    </div>


    <div class="row" ng-if="profile.profileData.person.householdId!==undefined">
      <profile-household household-info='profile.profileData.person' household-form='profile.householdForm' />
    </div>
    <!--/row-->

    <button id="save-personal" class="btn btn-primary" data-style="expand-left" ng-class='profile.buttonCss'  ng-click='profile.savePersonal()' >
      {{profile.buttonText}}
    </button>
  </ng-form>

</section>
