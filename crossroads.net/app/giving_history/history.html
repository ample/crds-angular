<div class="row giving-history">
  <div class="col-sm-10 col-sm-offset-1">
    <h1 class="hidden-print page-header">Giving History</h1>
    <h1 class="visible-print-block page-header">Giving Statement</h1>
    <h2 class="subheading hidden-print">Your history of financial giving to crossroads</h2>
    <h3 class="subheading visible-print-block">Printed: {{giving_history_controller.currentDate | date:'M/d/yy'}}</h3>

    <div class="row push-top" ng-show="giving_history_controller.history && giving_history_controller.viewReady">
      <address class="col-sm-12 hidden-print">
        <strong id="householdNamePrint">{{giving_history_controller.profile.householdName}}</strong><br>
        <span id="addressLine1Print">{{giving_history_controller.profile.addressLine1}}</span>
        <span id="addressLine2Print" ng-if="giving_history_controller.profile.addressLine2">, {{giving_history_controller.profile.addressLine2}}</span><br>
        <span id="cityPrint">{{giving_history_controller.profile.city}}</span>,
        <span id="statePrint">{{giving_history_controller.profile.state}}</span>
        <span id="postalCodePrint">{{giving_history_controller.profile.postalCode}}</span><br>
      </address>

      <address class="visible-print-block col-xs-6">
        <strong id="householdName">{{giving_history_controller.profile.householdName}}</strong><br>
        <span id="addressLine1">{{giving_history_controller.profile.addressLine1}}</span>
        <span id="addressLine2" ng-if="giving_history_controller.profile.addressLine2">, {{giving_history_controller.profile.addressLine2}}</span><br>
        <span id="city">{{giving_history_controller.profile.city}}</span>,
        <span id="state">{{giving_history_controller.profile.state}}</span>
        <span id="postalCode">{{giving_history_controller.profile.postalCode}}</span><br>
      </address>

      <p class="visible-print-block col-xs-6 text-right">
        <strong>Period : 01/01/{{giving_history_controller.currentDate | date:'yyyy'}} - {{giving_history_controller.currentDate | date:'MM/dd/yyyy'}}</strong>
        <br />
        <small>No goods or services were provided by Crossroads in exchange for the contributions recorded on this statement.</small>
      </p>
    </div>

    <preloader full-screen='false' ng-show="!giving_history_controller.viewReady"> </preloader>

    <!--  NO GIVING HISTORY - ng-show or ng-if on no data from resource  -->
    <div ng-show="!giving_history_controller.history && giving_history_controller.viewReady" class="no-data">
      <div class="row">
        <div class="col-sm-6 col-sm-offset-3">
          <svg viewBox="0 0 32 32" class="icon icon-clock3">
            <use xlink:href="#clock3"></use>
          </svg>
          <svg viewBox="0 0 18 32" class="icon icon-dollar">
            <use xlink:href="#dollar"></use>
          </svg>
          <div ng-bind-html="$root.MESSAGES.no_giving_history.content | html">
          </div>
        </div><!--/col-sm-12-->
      </div><!--/row-->
    </div><!--/no-data-->

    <!-- GIVING HISTORY - ng-show or ng-if on data from resource-->
    <div ng-show="giving_history_controller.history && giving_history_controller.viewReady">
      <div class="row">
        <div class="col-sm-6 clearfix hidden-print">
          <a href="" class="btn btn-primary col-sm-6 col-md-5 col-xs-12 mobile-push-bottom" onClick="window.print();">Print Statement</a>
        </div>
        <!--/col-sm-6-->
        <!-- DIRECTIVE: Giving Years -->
        <div class="col-sm-6">
          <form class="form-inline hidden-print">
            <div class="form-group sm-pull-right">
              <label for="giving-year">Year&nbsp;</label>
              <select class="form-control" id="giving-year" name="giving-year"
                      ng-model="giving_history_controller.selected_giving_year"
                      ng-options="year.value for year in giving_history_controller.donation_years track by year.key"
                      ng-change="giving_history_controller.getDonations()">
              </select>
            </div>
          </form>
        </div>
        <!--/col-sm-6-->
        <!-- END DIRECTIVE: Giving Years  -->
      </div>
      <!--/row push-top-->
      <!-- DIRECTIVE: Giving History - Full View -->
      <table class="table gift-table push-top">
        <thead class="visible-print-table">
          <tr>
            <th>Initiative / Payment Type</th>
            <th class="text-right">Amount / Date</th>
          </tr>
        </thead>
        <tbody ng-repeat="donation in giving_history_controller.donations track by $index">
          <tr ng-repeat="distribution in donation.distributions track by $index" ng-class="{'pending hidden-print' : donation.status == 'Pending'}">
            <td>
              {{distribution.program_name}}
              <span ng-if="donation.status == 'Pending'" class="label label-default" tooltip-placement="right" tooltip="This payment is still in the process of being cleared by our accounting team.">Pending</span>
              <span ng-if="donation.status == 'Declined'" class="label label-danger" tooltip-placement="right" tooltip="This payment has been declined.">Declined</span>
              <span ng-if="donation.status == 'Refunded'" class="label label-info" tooltip-placement="right" tooltip="This is a refund that has been issued to you.">Refund</span>
              <div class="text-muted">
                <svg ng-attr-viewBox="{{donation.source.viewBox}}" ng-class="'icon icon-' + donation.source.icon + 'payment-type-icon'">
                  <use ng-attr-xlink:href="{{'#' + donation.source.icon}}" xlink:href=""></use>
                </svg>
                {{donation.source.name}}
              </div>
            </td>
            <td class="text-right">
              <div ng-class="{ 'dollar-amount-decline' : donation.status == 'Declined', 'dollar-amount' : donation.status != 'Declined'}"><span ng-if="donation.status == 'Refunded'">&#45;</span>${{distribution.amount / 100}}</div>
              <div class="text-muted">{{donation.date | date:'M/d/yy'}}</div>
            </td>
          </tr>
        </tbody>
        <!-- TODO Remove commented markup, left in just in case we missed anything in the above ng-repeat -->
        <!--tbody>
          <tr>
            <td>
              Fake donations follow
              <div class="text-muted">
                <svg viewBox="0 0 160 100" class="icon icon-cc_visa payment-type-icon">
                  <use xlink:href="#cc_visa"></use>
                </svg>
                ending in 3459
              </div>
            </td>
            <td class="text-right">
              <div class="dollar-amount">$100.00</div>
              <div class="text-muted">10/12/15</div>
            </td>
          </tr>
          <tr>
            <td>
              Ministry
              <div class="text-muted">
                <svg viewBox="0 0 160 100" class="icon icon-cc_visa payment-type-icon">
                  <use xlink:href="#cc_visa"></use>
                </svg>
                ending in 3459
              </div>
            </td>
            <td class="text-right">
              <div class="dollar-amount">$100.00</div>
              <div class="text-muted">10/12/15</div>
            </td>
          </tr>
          <tr>
            <td>
              Ministry
              <div class="text-muted">
                <svg viewBox="0 0 160 100" class="icon icon-cc_visa payment-type-icon">
                  <use xlink:href="#cc_visa"></use>
                </svg>
                ending in 3459
              </div>
            </td>
            <td class="text-right">
              <div class="dollar-amount">$100.00</div>
              <div class="text-muted">10/12/15</div>
            </td>
          </tr>
          <tr>
            <td>
              Ministry
              <div class="text-muted">
                <svg viewBox="0 0 160 100" class="icon icon-cc_visa payment-type-icon">
                  <use xlink:href="#cc_visa"></use>
                </svg>
                ending in 3459
              </div>
            </td>
            <td class="text-right">
              <div class="dollar-amount">$100.00</div>
              <div class="text-muted">10/12/15</div>
            </td>
          </tr>
          <tr>
            <td>
              Ministry
              <div class="text-muted">
                <svg viewBox="0 0 160 100" class="icon icon-cc_visa payment-type-icon">
                  <use xlink:href="#cc_visa"></use>
                </svg>
                ending in 3459
              </div>
            </td>
            <td class="text-right">
              <div class="dollar-amount">$100.00</div>
              <div class="text-muted">10/12/15</div>
            </td>
          </tr>
          <tr>
            <td>
              Ministry
              <div class="text-muted">
                <svg viewBox="0 0 160 100" class="icon icon-cc_visa payment-type-icon">
                  <use xlink:href="#cc_visa"></use>
                </svg>
                ending in 3459
              </div>
            </td>
            <td class="text-right">
              <div class="dollar-amount">$100.00</div>
              <div class="text-muted">10/12/15</div>
            </td>
          </tr>
          <tr>
            <td>
              Ministry
              <div class="text-muted">
                <svg viewBox="0 0 160 100" class="icon icon-cc_visa payment-type-icon">
                  <use xlink:href="#cc_visa"></use>
                </svg>
                ending in 3459
              </div>
            </td>
            <td class="text-right">
              <div class="dollar-amount">$100.00</div>
              <div class="text-muted">10/12/15</div>
            </td>
          </tr>
          <tr>
            <td>
              Ministry
              <div class="text-muted">
                <svg viewBox="0 0 160 100" class="icon icon-cc_visa payment-type-icon">
                  <use xlink:href="#cc_visa"></use>
                </svg>
                ending in 3459
              </div>
            </td>
            <td class="text-right">
              <div class="dollar-amount">$100.00</div>
              <div class="text-muted">10/12/15</div>
            </td>
          </tr>
          <tr>
            <td>
              Ministry
              <div class="text-muted">
                <svg viewBox="0 0 160 100" class="icon icon-cc_visa payment-type-icon">
                  <use xlink:href="#cc_visa"></use>
                </svg>
                ending in 3459
              </div>
            </td>
            <td class="text-right">
              <div class="dollar-amount">$100.00</div>
              <div class="text-muted">10/12/15</div>
            </td>
          </tr>
          <tr>
            <td>
              Ministry
              <div class="text-muted">
                <svg viewBox="0 0 160 100" class="icon icon-cc_visa payment-type-icon">
                  <use xlink:href="#cc_visa"></use>
                </svg>
                ending in 3459
              </div>
            </td>
            <td class="text-right">
              <div class="dollar-amount">$100.00</div>
              <div class="text-muted">10/12/15</div>
            </td>
          </tr>
          <tr>
            <td>
              Ministry
              <div class="text-muted">
                <svg viewBox="0 0 160 100" class="icon icon-cc_visa payment-type-icon">
                  <use xlink:href="#cc_visa"></use>
                </svg>
                ending in 3459
              </div>
            </td>
            <td class="text-right">
              <div class="dollar-amount">$100.00</div>
              <div class="text-muted">10/12/15</div>
            </td>
          </tr>
          <tr>
            <td>
              Ministry
              <div class="text-muted">
                <svg viewBox="0 0 160 100" class="icon icon-cc_visa payment-type-icon">
                  <use xlink:href="#cc_visa"></use>
                </svg>
                ending in 3459
              </div>
            </td>
            <td class="text-right">
              <div class="dollar-amount">$100.00</div>
              <div class="text-muted">10/12/15</div>
            </td>
          </tr>
          <tr>
            <td>
              Ministry
              <div class="text-muted">
                <svg viewBox="0 0 160 100" class="icon icon-cc_visa payment-type-icon">
                  <use xlink:href="#cc_visa"></use>
                </svg>
                ending in 3459
              </div>
            </td>
            <td class="text-right">
              <div class="dollar-amount">$100.00</div>
              <div class="text-muted">10/12/15</div>
            </td>
          </tr>
          <tr>
            <td>
              Ministry <span class="label label-info" tooltip-placement="right" tooltip="This is a refund that has been issued to you.">Refund</span>
              <div class="text-muted">
                <svg viewBox="0 0 160 100" class="icon icon-cc_visa payment-type-icon">
                  <use xlink:href="#cc_visa"></use>
                </svg>
                ending in 3459
              </div>
            </td>
            <td class="text-right">
              <div class="dollar-amount">&#45;$100.00</div>
              <div class="text-muted">10/12/15</div>
            </td>
          </tr>
          <tr>
            <td>
              Ministry
              <div class="text-muted">
                <svg viewBox="0 0 160 100" class="icon icon-cc_visa payment-type-icon">
                  <use xlink:href="#cc_visa"></use>
                </svg>
                ending in 3459
              </div>
            </td>
            <td class="text-right">
              <div class="dollar-amount">$100.00</div>
              <div class="text-muted">10/12/15</div>
            </td>
          </tr>
          <tr>
            <td>
              Ministry <span class="label label-danger" tooltip-placement="right" tooltip="This payment has been declined.">Declined</span>
              <div class="text-muted">
                <svg viewBox="0 0 32 32" class="icon icon-library payment-type-icon">
                  <use xlink:href="#library"></use>
                </svg>
                ending in 3459
              </div>
            </td>
            <td class="text-right">
              <div class="dollar-amount-decline">$100.00</div>
              <div class="text-muted">10/12/15</div>
            </td>
          </tr>

          <tr>
            <td>
              Game Change
              <div class="text-muted">
                <svg viewBox="0 0 32 32" class="icon icon-library payment-type-icon">
                  <use xlink:href="#library"></use>
                </svg>
                ending in 3459
              </div>
            </td>
            <td class="text-right">
              <div class="dollar-amount">$200.00</div>
              <div class="text-muted">12/16/15</div>
            </td>
          </tr>

          <tr>
            <td>
              OSG
              <div class="text-muted">
                <svg viewBox="0 0 34 32" class="icon icon-money payment-type-icon">
                  <use xlink:href="#money"></use>
                </svg>
                cash
              </div>
            </td>
            <td class="text-right">
              <div class="dollar-amount">$55000.00</div>
              <div class="text-muted">12/24/15</div>
            </td>
          </tr>

          <tr class="pending hidden-print">
            <td>
              Ministry <span class="label label-default" tooltip-placement="right" tooltip="This payment is still in the process of being cleared by our accounting team.">Pending</span>
              <div class="text-muted">
                <svg viewBox="0 0 160 100" class="icon icon-cc_visa payment-type-icon">
                  <use xlink:href="#cc_visa"></use>
                </svg>
                ending in 3459
              </div>
            </td>
            <td class="text-right">
              <div class="dollar-amount">$100.00</div>
              <div class="text-muted">12/12/15</div>
            </td>
          </tr>
        </tbody-->
      </table>

      <h4 class="text-right hidden-print">Total: {{giving_history_controller.donation_total_amount / 100 | currency: '$'}}</h4>
      <!-- TODO Need to either calculate statement total (total - minus pending), or return it from API endpoint -->
      <h4 class="text-right visible-print-block">Total: {{giving_history_controller.donation_total_amount / 100 | currency}}</h4>
      
      <!-- END DIRECTIVE: Giving History - Full View -->
      
      <!-- ng-if or ng-show : soft credits exist -->
      <div class="other-gifts hidden-print">
        <hr />
        <h3>Other Gifts</h3>
        <p>
          These are donations that will not be included in your Crossroads giving statement. These are typically charity accounts or foundational giving where donations are made through a third party.
        </p>
        <!-- DIRECTIVE: Giving History - Soft Credits -->
        <table class="table gift-table push-top">
          <thead class="visible-print-table">
            <tr>
              <th>Initiative / Payment Type</th>
              <th class="text-right">Amount / Date</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                Ministry
                <div class="text-muted">
                  Fidelity Charity Account
                </div>
              </td>
              <td class="text-right">
                <div class="dollar-amount">$100.00</div>
                <div class="text-muted">9/12/15</div>
              </td>
            </tr>
            <tr>
              <td>
                Ministry
                <div class="text-muted">
                  Fidelity Charity Account
                </div>
              </td>
              <td class="text-right">
                <div class="dollar-amount">$100.00</div>
                <div class="text-muted">10/12/15</div>
              </td>
            </tr>
            <tr>
              <td>
                Ministry
                <div class="text-muted">
                  Fidelity Charity Account
                </div>
              </td>
              <td class="text-right">
                <div class="dollar-amount">$100.00</div>
                <div class="text-muted">11/12/15</div>
              </td>
            </tr>
            <tr>
              <td>
                Ministry
                <div class="text-muted">
                  Fidelity Charity Account
                </div>
              </td>
              <td class="text-right">
                <div class="dollar-amount">$100.00</div>
                <div class="text-muted">12/12/15</div>
              </td>
            </tr>
          </tbody>
        </table>
        <h4 class="text-right hidden-print">Total: $300.00</h4>
        <!-- DIRECTIVE: Giving History - Soft Credits -->
      </div>

      <p class="push-top hidden-print">Question about your giving? <a href="#">Email our finance team</a>
        <br />
      </p>

      <div class="row giving-statement-footer visible-print-block">
        <div class="col-xs-12">
          <div class="logo">
            <img src="//crossroads-media.s3.amazonaws.com/images/logo.svg" alt="crossroads">
          </div>
          <div class="statement-address text-uppercase">
            <small>3500 Madison Road, Cincinnati, OH 45209 P513.731.7400 F513.731.3978 crossroads.net</small>
          </div>
        </div>
      </div>

    </div>


  </div><!--/col-sm-10-->
</div><!--/row-->
