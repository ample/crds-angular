<form role="form" name="personal" ng-init="profile.initProfile(this)" novalidate>

    <p class="text-muted push-bottom">Information shared here is kept secure and private. We will not share or sell your information.</p>

    <div class="row">
        <div class="form-group col-sm-6" ng-class="{'has-error':personal.firstName.$invalid}">
            <label for="firstname">First Name</label>
            <input type="text" name="firstName" class="form-control" id="firstname" placeholder="Enter first name" ng-model="profile.person.First_Name" ng-model-options="{ debounce : { 'default' : 500, blur : 0 } }" required>
            <ng-messages for="personal.firstName.$error" ng-if="personal.$submitted">
                <span ng-message="required">{{$root.MESSAGES.fieldCanNotBeBlank}}</span>
            </ng-messages>
        </div>

        <div class="form-group col-sm-6">
            <label for="middlename">Middle Name</label>
            <input type="text" class="form-control" id="middlename" placeholder="Enter middle name" ng-model="profile.person.Middle_Name">
        </div>

        <div class="form-group col-sm-6" ng-class="{'has-error':personal.lastName.$invalid}">
            <label for="lastname">Last Name</label>
            <input type="text" class="form-control" id="lastName" name="lastName" placeholder="Enter last name" ng-model="profile.person.Last_Name" ng-model-options="{ debounce : { 'default' : 500, blur : 0 } }" required>
            <ng-messages for="personal.lastName.$error" ng-if="personal.$submitted">
                <span ng-message="required">{{$root.MESSAGES.fieldCanNotBeBlank}}</span>
            </ng-messages>
        </div>

        <div class="form-group col-sm-6">
            <label for="maidenname">Maiden Name</label>
            <input type="text" class="form-control" id="maidenname" placeholder="Enter maiden name" ng-model="profile.person.Maiden_Name">
        </div>

        <div class="form-group col-sm-6">
            <label for="nickname">Preferred Name <small class="text-muted">(Example: Rob or Becky)</small></label>
            <input type="text" class="form-control" id="nickname" placeholder="Enter nick name" ng-model="profile.person.NickName">
        </div>
    </div>

    <div class="row">
        <div class="form-group col-sm-6" ng-class="{'has-error':personal.email.$invalid}">
            <label for="email">Email</label>
            <input type="email" class="form-control" id="email" name="email" placeholder="Enter email address" ng-model="profile.person.Email_Address" ng-model-options="{ debounce : { 'default' : 1000, blur: 0} }"  required unique-email>
            <ng-messages for="personal.email.$error" ng-if="personal.$submitted">
                <span ng-message="required">{{$root.MESSAGES.fieldCanNotBeBlank}}</span>
                <span ng-message="unique">{{$root.MESSAGES.emailInUse}}</span>
            </ng-messages>
            <ng-messages for="personal.email.$error">
                <span ng-message="email">{{$root.MESSAGES.invalidEmail}}</span>
            </ng-messages>
        </div>
    </div>

    <div class="row" ng-controller="crdsDatePickerCtrl">
        <div class="col-sm-6" >
            <label class="control-label">Birth Date</label>
            <div class="input-group" ng-class="{'has-error':personal.birthdate.$invalid}">
                <input type="text" name="birthdate" class="form-control" datepicker-popup="MM/dd/yyyy"
                       datepicker-append-to-body="true"
                       ng-model="profile.person.Date_of_Birth"
                       is-open="opened"
                       datepicker-options="dateOptions"
                       date-disabled="disabled(date,mode)"
                       close-text="Close"
                       ng-click="open($event)" />
                <span class="input-group-btn">
                    <button type="button" class="btn btn-primary" ng-click="open($event)">Add</button>
                </span>
                
            </div>
            <ng-messages for="personal.birthdate.$error" ng-if="personal.$submitted">
                <span ng-message="required">{{$root.MESSAGES.fieldCanNotBeBlank}}</span> 
            </ng-messages>
            <ng-messages for="personal.birthdate.$error" ng-if="personal.$submitted || personal.$touched">
                <span ng-message="date">{{$root.MESSAGES.invalidData}}</span>
            </ng-messages>
        </div>
    </div>

    <div class="row">
        <div class="form-group col-sm-6">
            <label for="marital_status">Marital Status</label>
            <select class="form-control col-sm-12"
                    ng-model="profile.person.Marital_Status_Id"
                    ng-options="status.dp_RecordID as status.dp_RecordName for status in profile.maritalStatuses"></select>
        </div>

        <div class="form-group col-sm-6">
            <label class="block">Gender</label>
            <label class="radio-inline" ng-repeat="gender in profile.genders">
                <input type="radio" id="gender" ng-value="gender.dp_RecordID" ng-model="profile.person.Gender_Id"> {{ gender.dp_RecordName }}
            </label>
        </div>
    </div>

    <div class="row">
        <div class="form-group col-sm-6">
            <label for="employer">Employer</label>
            <input type="text" class="form-control" id="employer" placeholder="Enter employer" ng-model="profile.person.Employer_Name">
        </div>
    </div>

    <div class="row" ng-controller="crdsDatePickerCtrl">
        <div class="col-sm-6" ng-controller="crdsDatePickerCtrl" >
            <label class="control-label">When did you start attending Crossroads?</label>
            <div class="input-group" ng-class="{'has-error':personal.anniversarydate.$invalid}">
                <input type="text" name="anniversarydate" class="form-control" data-datepicker-popup="MM/dd/yyyy" ng-model="profile.person.Anniversary_Date" is-open="opened" datepicker-options="dateOptions" date-disabled="disabled(date, mode)" close-text="Close" ng-click="open($event)" />
                <span class="input-group-btn">
                    <button type="button" class="btn btn-primary" ng-click="open($event)">Date!</button>
                </span>
            </div>
            <ng-messages for="personal.anniversarydate.$error">
                <span ng-message="date">{{$root.MESSAGES.invalidData}}</span>
            </ng-messages>
        </div>
    </div>

    <div class="row">
        <div class="form-group col-sm-6" ng-class="{'has-error':personal.mobile.$invalid}">
            <label for="nickname">Mobile Phone</label>
            <input type="text"
                   class="form-control" name="mobile" id="mobile"
                   placeholder="Enter mobile phone"
                   ng-model="profile.person.Mobile_Phone"
                   ng-pattern="profile.phoneFormat"
                   ng-model-options="{ debounce : { 'default' : 500, blur : 0 } }"
                   ng-blur="profile.convertPhone()">
            <ng-messages for="personal.mobile.$error" ng-if="personal.$submitted || personal.$touched">
                <span ng-message="pattern">{{$root.MESSAGES.invalidPhone}}</span>
            </ng-messages>
        </div>
        <div class="form-group col-sm-6" ng-class="{'has-error':personal.serviceprovider.$invalid}">
            <label for="provider">Service Provider</label>
            <select name="serviceprovider" class="form-control col-sm-12" ng-model="profile.person.Mobile_Carrier_ID"
                    ng-options="providers.dp_RecordID as providers.dp_RecordName for providers in profile.serviceProviders" ng-required="profile.serviceProviderRequired()">
                <option value=""> -- Choose One -- </option>
            </select>
            <ng-messages for="personal.serviceprovider.$error" ng-if="personal.$submitted || personal.$touched">
                <span ng-message="pattern">{{$root.MESSAGES.fieldCanNotBeBlank}}</span>
            </ng-messages>
        </div>
    </div>

    <div class="row">
        <fieldset>
            <legend>Your Household</legend>
            <p>
                Update information for your household, which includes:<br />
                <strong>Tate Lucas</strong>, <strong>Christy Lucas</strong>, <strong>Sadie Lucas</strong>, <strong>Simon Lucas</strong>
                <!-- >a href="#" class="btn btn-xs btn-light-gray push-half-left">Add or remove another person</a-->
            </p>

            <div class="panel panel-default clearfix">
                <div class="panel-heading address-panel-heading clearfix" ng-click="isCollapsed = !isCollapsed">
                    <div class="row">
                        <a ng-click="isCollapsed = !isCollapsed" href="#" class="address-show" ng-show="isCollapsed">
                            <svg viewBox="0 0 32 32" class="icon icon-pencil4"><use xlink:href="/icons/cr.svg#pencil4"></use></svg>
                        </a>
                        <a ng-click="isCollapsed = !isCollapsed" href="#" class="address-show" ng-show="!isCollapsed">
                            <svg viewBox="0 0 18 32" class="icon icon-caret-up"><use xlink:href="/icons/cr.svg#caret-up"></use></svg>
                        </a>
                        <div class="col-md-7">
                            <svg viewBox="0 0 32 32" class="icon icon-home"><use xlink:href="/icons/cr.svg#home"></use></svg>3727 Hyde Park Ave, Cincinnati, OH 45209
                        </div>
                        <div class="col-md-2"><svg viewBox="0 0 32 32" class="icon icon-phone3"><use xlink:href="/icons/cr.svg#phone3"></use></svg>859-867-5309</div>
                        <div class="col-md-3"><svg viewBox="0 0 32 32" class="icon icon-crossroads"><use xlink:href="/icons/cr.svg#crossroads"></use> </svg>Crossroads Oakley</div>
                    </div><!--/row-->
                </div> <!--/panel-heading-->

                <div class="address-panel-body panel-body clearfix" collapse="isCollapsed">
                    <div class="col-sm-12">
                        <fieldset class="row">
                            <ul class="list-group clearfix">
                                <li class="list-group-item clearfix">
                                    <div class="form-group col-sm-6" ng-class="{'has-error':personal.address.$invalid}">
                                        <label for="street">Street</label>
                                        <input name="address" ng-model="profile.person.Address_Line_1" type="text" class="form-control" id="street" placeholder="Enter street address" required>
                                        <ng-messages for="personal.address.$error" ng-if="personal.$submitted">
                                            <span ng-message="required">{{$root.MESSAGES.fieldCanNotBeBlank}}</span>
                                        </ng-messages>
                                    </div>

                                    <div class="form-group col-sm-6">
                                        <label for="street2">Street 2</label>
                                        <input ng-model="profile.person.Address_Line_2" type="text" class="form-control" id="street2" placeholder="Enter street address (cont.)">
                                    </div>

                                    <div class="form-group col-sm-6" ng-class="{'has-error':personal.city.$invalid}">
                                        <label for="city">City</label>
                                        <input name="city" ng-model="profile.person.City" type="text" class="form-control" id="city" placeholder="Enter city" required>
                                        <ng-messages for="personal.city.$error" ng-if="personal.$submitted">
                                            <span ng-message="required">{{$root.MESSAGES.fieldCanNotBeBlank}}</span>
                                        </ng-messages>
                                    </div>

                                    <div class="form-group col-sm-6" ng-class="{'has-error':personal.state.$invalid}">
                                        <label for="state">State</label>
                                        <select name="state" class="form-control col-sm-12" ng-model="profile.person.State" ng-change="profile.stateChanged()" ng-options="state.State_Abbreviation for state in profile.states track by state.State_Abbreviation" required>
                                            <option value=""> -- Choose a State -- </option>
                                        </select>
                                        <ng-messages for="personal.zip.$error" ng-if="personal.$submitted">
                                            <span ng-message="required">{{$root.MESSAGES.fieldCanNotBeBlank}}</span>
                                        </ng-messages>
                                    </div>

                                    <div class="form-group col-sm-6" ng-class="{'has-error':personal.zip.$invalid}">
                                        <label for="zip">Zip</label>
                                        <input name="zip" ng-model="profile.person.Postal_Code" type="text" class="form-control" id="zip" placeholder="Enter zip code" required ng-pattern="profile.zipFormat">
                                        <ng-messages for="personal.zip.$error" ng-if="personal.$submitted">
                                            <span ng-message="required">{{$root.MESSAGES.fieldCanNotBeBlank}}</span>
                                        </ng-messages>
                                        <ng-messages for="personal.zip.$error">
                                            <span ng-message="pattern">{{$root.MESSAGES.invalidZip}}</span>
                                        </ng-messages>

                                    </div>

                                    <div class="form-group col-sm-6" ng-class="{'has-error':personal.country.$invalid}">
                                        <label for="country">Country</label>
                                        <select name="country" ng-model="profile.person.Foreign_Country" ng-change="setCountry()" ng-options="country.dp_RecordName for country in profile.countries track by country.dp_RecordName" class="form-control col-sm-12"></select>
                                        <ng-messages for="personal.country.$error" ng-if="personal.$submitted">
                                            <span ng-message="required">{{$root.MESSAGES.fieldCanNotBeBlank}}</span>
                                        </ng-messages>
                                    </div>

                                </li>
                                <li class="list-group-item clearfix" ng-class="{'has-error':personal.homephone.$invalid}">
                                    <div class="form-group col-sm-6">
                                        <label for="homephone">Home Phone</label>
                                        <input name="homephone" ng-model="profile.person.Home_Phone" type="text" class="form-control" id="homephone" ng-pattern="phoneFormat" placeholder="Enter home phone" ng-blur="profile.convertHomePhone()">
                                        <ng-messages for="personal.homephone.$error" ng-if="personal.$submitted || personal.$touched">
                                            <span ng-message="pattern">{{$root.MESSAGES.invalidPhone}}</span>
                                        </ng-messages>
                                    </div>
                                </li>
                                <li class="list-group-item clearfix">
                                    <div id="Site" class="form-group col-sm-6">
                                        <label for="provider">Crossroads Location</label>
                                        <select class="form-control col-sm-12" ng-model="profile.person.Congregation_ID" ng-options="congregation.dp_RecordID as congregation.dp_RecordName for congregation in profile.crossroadsLocations"></select>
                                    </div>
                                </li>
                            </ul>
                        </fieldset>
                        <!----form-->
                        <!----div--><!--/col-sm-12-->
                    </div><!--/panel-body-->
                </div><!--/panel-->

        </fieldset>
    </div>

    <button id="save-personal" ng-click="profile.savePersonal()" class="btn btn-primary" data-style="expand-left">
        Save
    </button>
</form>


